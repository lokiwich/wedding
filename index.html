<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>کارت دعوت عروسی</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lalezar&family=Lateef:wght@400;700&family=Vazirmatn:wght@300;400;700&family=Dynalight&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* * فونت‌های استفاده شده:
         * 'Dynalight': برای اسامی انگلیسی روی جلد
         * 'Lalezar': برای عناوین اصلی و بزرگ
         * 'Lateef': برای اسامی و شعر (شبیه به نستعلیق)
         * 'Vazirmatn': برای متن‌های عمومی و توضیحات
        */
        body {
            font-family: 'Vazirmatn', sans-serif;
            background-color: hsl(114, 53%, 88%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
        }

        .booklet-wrapper {
            position: relative;
            width: 340px; 
            height: 500px; 
            cursor: pointer;
            transform-style: preserve-3d;
            transition: transform 1s ease-in-out;
        }
        
        /* حالت باز شدن در دسکتاپ (از بغل) */
        .booklet-wrapper.open {
            transform: translateX(170px) scale(1.05); /* Move to center the booklet when open */
        }

        .cover {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.2), 0 5px 20px rgba(0,0,0,0.3);
            transform-origin: left center; /* مبدا چرخش برای دسکتاپ */
            transition: transform 1.2s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            transform-style: preserve-3d;
            z-index: 10;
            border-radius: 8px;
        }
        
        .cover-front-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            background-image: url('/jeld.webp');
            background-size: cover;
            background-position: center center;
            border-radius: 8px;
        }
        
        .cover-back-face {
             position: absolute;
             width: 100%;
             height: 100%;
             backface-visibility: hidden;
             background-image: url('/jeld.webp');
             background-size: cover;
             background-position: center;
             transform: rotateY(180deg);
             border-radius: 8px;
        }
        
        .booklet-wrapper.open .cover {
            transform: rotateY(-160deg);
        }

        .cover-names {
            position: relative;
            font-family: 'Dynalight', cursive;
            font-size: 3.5rem;
            width: 100%;
            height: 100%;
            text-align: center;
            color: #fde047; /* A warm gold color */
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
            opacity: .9;
            user-select: none;
        }

        /* کارت دعوت داخلی */
        .invitation-card {
            position: absolute;
            top: 15px;
            left: 15px;
            width: calc(100% - 30px);
            height: calc(100% - 30px);
            background-color: #fffaf0;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
            z-index: 5;
            transition: all 0.5s 0.5s ease-out;
            transform: scale(0.98);
            display: flex;
            justify-content: center;
            align-items: center;
            color: #4a044e;
            opacity: 0;
        }
        
        .booklet-wrapper.open .invitation-card {
            opacity: 1;
            transform: scale(1.07);
        }
        
        .page {
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center center;
            display: flex;
            border-radius: 8px;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 4px;
            text-align: center;
            cursor: zoom-in;
        }
        
        h1, h2, p { margin: 0; }

        /* --- استایل‌های اصلاح شده مخصوص موبایل --- */
        @media (max-width: 640px) {
            .booklet-wrapper {
                /* * تغییر اصلی اینجاست: 
                 * کارت به جای پایین، به سمت بالا حرکت می‌کند تا روی دکمه‌ها را نپوشاند.
                */
                transform: translateY(-40px) scale(0.9) !important;  
            }
            .booklet-wrapper.open {
                /* * تغییر اصلی اینجاست: 
                 * کارت به جای پایین، به سمت بالا حرکت می‌کند تا روی دکمه‌ها را نپوشاند.
                */
                transform: translateY(-60px) scale(0.9) !important; 
            }
            .cover {
                transform-origin: top center; /* مبدا چرخش از بالا */
            }
            .booklet-wrapper.open .cover {
                transform: rotateX(160deg);
            }
        }

        /* -- استایل‌های مودال و دکمه نشان -- */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            display: none; /* Initially hidden */
            justify-content: center;
            align-items: center;
            z-index: 1000;
            cursor: zoom-out;
        }
        .modal-overlay.visible {
            display: flex;
        }
        .modal-content {
            position: relative;
            max-width: 95vw;
            max-height: 95vh;
            transform: scale(0.7);
            transition: transform 0.3s ease-out;
        }
        .modal-overlay.visible .modal-content {
            transform: scale(1);
        }
        .modal-content img {
            width: auto;
            height: auto;
            max-width: 100%;
            max-height: 100%;
            border-radius: 8px;
        }
        .close-button {
            position: absolute;
            top: 15px;
            right: 15px;
            color: white;
            background-color: #4a044e;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.8rem;
            line-height: 1;
            cursor: pointer;
            border: 2px solid white;
        }

        #neshan-button {
            display: none; /* Initially hidden */
            background-color: #26a69a; /* Neshan-like color */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            text-decoration: none;
            font-weight: bold;
            font-family: 'Vazirmatn', sans-serif;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            z-index: 20;
        }
        #neshan-button:hover {
            background-color: #2bbbad;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>

    <div class="booklet-wrapper" id="booklet-wrapper">
        <div class="invitation-card">
            <!-- برای راحتی در انتخاب، یک آیدی به تصویر اضافه شد -->
            <img src="/cart.jpg" class="page" id="invitation-image" alt="کارت دعوت">
        </div>
        <div class="cover" id="cover">
            <div class="cover-front-face">
                <div class="cover-names">
                    <p style="position: absolute; top: 30%; left: 24%;">Pardis</p>
                    <p style="position: absolute; top: 40%; left: 43%">&</p>
                    <p style="position: absolute; top: 50%; left: 48%">Ali</p>
                </div>
            </div>
            <div class="cover-back-face"></div>
        </div>
    </div>

    <!-- این کانتینر برای دکمه و راهنماست -->
    <div class="fixed bottom-10 w-full flex flex-col items-center justify-center z-50 text-center px-4">
        <!-- راهنمای اولیه برای کلیک -->
        <div id="click-instruction" class="text-gray-500 transition-opacity duration-500 bg-white/70 backdrop-blur-sm px-3 py-1 rounded-full">
            <p>برای باز کردن روی کارت کلیک کنید</p>
        </div>
    
        <!-- دکمه نشان (در ابتدا مخفی است) -->
        <!-- لطفا lat و lng و title را با مشخصات مکان مورد نظر خود جایگزین کنید -->
        <a href="https://nshn.ir/sb_bhbxBNFoIY9" id="neshan-button">
            📍 باز کردن در نشان
        </a>
    </div>

    <!-- مودال بزرگنمایی تصویر (در ابتدا مخفی است) -->
    <div id="image-modal" class="modal-overlay">
        <span class="close-button" id="close-modal">&times;</span>
        <!-- اصلاح تگ اشتباه iv به div -->
        <div class="modal-content">
         <img src="" alt="کارت دعوت" id="zoomed-image">
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const bookletWrapper = document.getElementById('booklet-wrapper');
            const clickInstruction = document.getElementById('click-instruction');
            const neshanButton = document.getElementById('neshan-button');
            const invitationImage = document.getElementById('invitation-image');
            const imageModal = document.getElementById('image-modal');
            const zoomedImage = document.getElementById('zoomed-image');
            const closeModal = document.getElementById('close-modal');

            // مدیریت باز و بسته شدن کارت و نمایش دکمه‌ها
            bookletWrapper.addEventListener('click', function(event) {
                // جلوگیری از بسته شدن کارت هنگام کلیک روی عکس داخلی برای زوم
                if (event.target.id === 'invitation-image' && this.classList.contains('open')) {
                    return;
                }
                
                this.classList.toggle('open');
                
                if (this.classList.contains('open')) {
                    if (clickInstruction) clickInstruction.style.display = 'none';
                    if (neshanButton) neshanButton.style.display = 'inline-block';
                } else {
                    if (clickInstruction) clickInstruction.style.display = 'block';
                    if (neshanButton) neshanButton.style.display = 'none';
                }
            });

            // باز کردن مودال برای بزرگنمایی تصویر
            invitationImage.addEventListener('click', function() {
                // فقط در صورتی که کارت باز باشد، زوم عمل کند
                if (bookletWrapper.classList.contains('open')) {
                    zoomedImage.src = this.src;
                    imageModal.classList.add('visible');
                }
            });

            // تابع برای بستن مودال
            const hideModal = () => {
                imageModal.classList.remove('visible');
            };

            // بستن مودال با کلیک روی دکمه بستن یا پس‌زمینه تیره
            closeModal.addEventListener('click', hideModal);
            imageModal.addEventListener('click', function(event) {
                 // فقط اگر روی خود پس‌زمینه کلیک شد مودال بسته شود نه روی عکس
                 if (event.target === imageModal) {
                    hideModal();
                 }
            });
        });
    </script>
</body>
</html>
